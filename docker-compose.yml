services:
  warproxy.server:
    image: ghcr.io/kingcc/warproxy:latest
    depends_on:
      - dns.server
    restart: always
    dns:
      - 172.16.0.3
    environment:
      - WARP_PLUS=true
      - HTTP_PORT=1081
    networks:
      warproxy.network:
        ipv4_address: 172.16.0.2
    ports:
      - 127.0.0.1:1080:1080
      - 127.0.0.1:1081:1081

  dns.server:
    image: dnomd343/cleardns:latest
    restart: always
    networks:
      warproxy.network:
        ipv4_address: 172.16.0.3

networks:
  warproxy.network:
    external: true
    name: warproxy.network
